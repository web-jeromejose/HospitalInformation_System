@{
    ViewBag.Title = "Index";
}
<section class="content-header">
    <h1>Country  Details Configuration 
        <small></small>
    </h1>
    <code>Country to City setup</code>
    <ol class="breadcrumb">
        <li><a href="#"><i class="fa fa-dashboard"></i>IT Admin</a></li>
        <li class="active">Country</li>
    </ol>
</section>

<!-- Main content -->
<section class="content">
    <div class="row">
        <div class="col-md-12">
            <!-- Custom Tabs -->
            <div class="nav-tabs-custom">
                <ul class="nav nav-tabs">
                    <li class="active"><a href="#MainTable" data-toggle="tab"><i class="fa  fa-arrow-circle-right"></i>Main Table</a></li>
                    <li class=" "><a href="#CountryTab" data-toggle="tab"><i class="fa fa-flag-checkered"></i>Country</a></li>
                    <li><a href="#CityTAB" data-toggle="tab" onclick="ns.loadDTCity();"><i class="fa fa-flag-o"></i>City</a></li>

                    <li class="pull-right"><a href="#" class="text-muted"><i class="fa fa-gear"></i></a></li>
                </ul>
                <div class="tab-content">

                    <div class="tab-pane active" id="MainTable">
                        <div class="row">
                            <div class="col-md-6">                                
                                <div class="box box-primary direct-chat direct-chat-success">
                                    <div class="box-header with-border">
                                        <h3 class="box-title">Add Country</h3>
                                        <div class="box-tools pull-right">

                                            <button type="button" class="btn btn-box-tool hidewidget" data-widget="collapse">
                                                <i class="fa fa-minus"></i>
                                            </button>
                                            <button type="button" class="btn btn-box-tool" data-widget="remove"><i class="fa fa-times"></i></button>
                                        </div>
                                    </div>
                                    <!-- /.box-header -->
                                    <div class="box-body">
                                        <div class="box box-primary">
                                            <br />
                                            <form role="form" id="FormSubmitAddCountry">
                                                <div class="box-body">
                                                    <div class="form-group">
                                                        <label for="zoneCode">Name</label>
                                                        <input type="text" class="form-control" id="AddCountryName" placeholder="County name..." required>
                                                    </div>
                                                    <div class="form-group">
                                                        <label for="zoneName">Iso Name</label>
                                                        <input type="text" class="form-control" id="AddCountryIsoCode" placeholder="eg. SA / PH  " required>
                                                    </div>
                                                    <div class="form-group">
                                                        <label for="AddCountryPhoneCode">Phone Code</label>
                                                        <div class="input-group">
                                                            <span class="input-group-addon">+</span>
                                                            <input type="number" id="AddCountryPhoneCode" class="form-control">
                                                            <span class="input-group-addon"><i class="fa fa-check"></i></span>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="box-footer">
                                                    <button type="submit" class="btn btn-primary" style="display: none">Submit</button>
                                                    <button type="button" class="btn btn-primary" onclick="ns.FormSubmitAddCountry()">Add Country</button>
                                                </div>
                                            </form>
                                        </div>
                                    </div>
                                    <!-- /.box-body -->
                                </div>                            
                            </div>
                            <!-- /.col -->
                            <div class="col-md-6">
                              
                                <div class="box box-primary direct-chat direct-chat-success">
                                    <div class="box-header with-border">
                                        <h3 class="box-title">Add City</h3>
                                        <div class="box-tools pull-right">

                                            <button type="button" class="btn btn-box-tool hidewidget" data-widget="collapse">
                                                <i class="fa fa-minus"></i>
                                            </button>
                                            <button type="button" class="btn btn-box-tool" data-widget="remove"><i class="fa fa-times"></i></button>
                                        </div>
                                    </div>
                                    <!-- /.box-header -->
                                    <div class="box-body">
                                        <div class="box box-primary">
                                            <br />

                                            <div class="form-horizontal">
                                                <div class="form-group">
                                                    <label class="control-label col-sm-3">Country</label>
                                                    <div class="col-sm-6">
                                                        <input type="text" id="select2Country" class="form-control select2 select2-hidden-accessible" style="width: 100%;" tabindex="-1" aria-hidden="true" />
                                                    </div>
                                                </div>

                                                <div class="form-group">
                                                    <label class="control-label col-sm-3">Existing City</label>
                                                    <div class="col-sm-6">
                                                        <select id="citylist" multiple="" class="form-control" disabled=""></select>
                                                    </div>
                                                </div>

                                                <div class="form-group">
                                                    <label class="control-label col-sm-3">City</label>
                                                    <div class="col-sm-6">
                                                        <textarea class="form-control" rows="6" id="CityTextArea" placeholder="FORMAT: City1 , City2 , City3 , City4 , "></textarea>
                                                    </div>
                                                </div>

                                            </div>


                                        </div>
                                    </div>
                                       <div class="box-footer">
                                                  <button type="button" class="btn btn-primary"  onclick="ns.AddCity()" >Add City</button>
                                        </div>
                                    <!-- /.box-body -->

                                </div>
                                
                            </div>
                            <!-- /.col -->
                        </div>
                    </div>
                    <!-- /.tab-pane -->
                    <div class="tab-pane " id="CountryTab">

                        <div class="row">
                            <div class="col-md-12">
                                <!-- DIRECT CHAT PRIMARY -->
                                <div class="box box-success direct-chat direct-chat-success">
                                    <div class="box-header with-border">
                                        <h3 class="box-title">Country Details</h3>
                                        <br />
                                        <div class="box-tools pull-right">
                                            <button type="button" class="btn btn-info" onclick="location.reload();">Refresh</button>
                                            <button type="button" class="btn btn-box-tool " data-widget="collapse">
                                                <i class="fa fa-minus"></i>
                                            </button>
                                            <button type="button" class="btn btn-box-tool" data-widget="remove"><i class="fa fa-times"></i></button>
                                        </div>
                                    </div>

                                    <div class="box-body">
                                        <br />
                                        <br />
                                        <div class="col-sm-12" style="overflow: auto; height: 50%; width: 100%;">
                                            <table id="gridDataTable" class="table table-bordered table-hover" style="">
                                                <thead class="ColumnHeader">
                                                    <tr></tr>
                                                </thead>
                                            </table>
                                        </div>
                                      
                                    </div>
                                    <div class="box-footer">
                                    </div>

                                </div>

                            </div>
                        </div>




                    </div>
                    <div class="tab-pane" id="CityTAB">
                        
                        <div class="row">
                            <div class="col-md-12">
                                <!-- DIRECT CHAT PRIMARY -->
                                <div class="box box-success direct-chat direct-chat-success">
                                    <div class="box-header with-border">
                                        <h3 class="box-title">City Details</h3>
                                        <br />
                                        <div class="box-tools pull-right">
                                            <button type="button" class="btn btn-info" onclick="location.reload();">Refresh</button>
                                            <button type="button" class="btn btn-box-tool " data-widget="collapse">
                                                <i class="fa fa-minus"></i>
                                            </button>
                                            <button type="button" class="btn btn-box-tool" data-widget="remove"><i class="fa fa-times"></i></button>
                                        </div>
                                    </div>

                                    <div class="box-body">
                                        <br />
                                        <br />
                                        <div class="col-sm-12" style="overflow: auto; height: 50%; width: 100%;">
                                            <table id="gridDTCity" class="table table-bordered table-hover" style="">
                                                <thead class="ColumnHeader">
                                                    <tr></tr>
                                                </thead>
                                            </table>
                                        </div>
                                        
                                    </div>
                                    <div class="box-footer">
                                    </div>

                                </div>

                            </div>
                        </div>
                    </div>
                    <!-- /.tab-pane -->
                </div>
                <!-- /.tab-content -->
            </div>
            <!-- nav-tabs-custom -->
        </div>
    </div>
</section>
<input type="hidden" id="url"    
data-dashboard="@Url.Action("CountryDashboard")"
data-save="@Url.Action("Save")"
data-select2country="@Url.Action("select2country")"
data-select2city="@Url.Action("select2citybycountryid")"    
data-addcountry="@Url.Action("AddCountrySave")"    
data-addcity="@Url.Action("AddCitySave")"    
data-citylist="@Url.Action("CityDashboard")"    
data-updatecity="@Url.Action("UpdateCity")"    
    
/>

<script>
    var c = new Common();
    jQuery(document).ready(function () {
        $('.sidebar-toggle').click();
        setTimeout(
            function () {
                 $('.hidewidget').click();

                ns.loadDT();
            }
            , 1000);
        ns.InitSelect2();
        ns.initBeforeFormSubmission();

    });

    (function ($) {
        var namespace;
        var quit = false;
        var Tbldashboard;
        var TbldashboardId = '#gridDataTable';
        var TbldashboardDataRow;

        var TblDTCity;
        var TblDTCityId = '#gridDTCity';
        var TblDTCityDataRow;


        namespace = {
            initBeforeFormSubmission: function () {

                $('#FormSubmitAddCountry').submit(function (e) {
                    e.preventDefault();
                    var entry = {
                        Name: $('#AddCountryName').val(),
                        IsoCode: $('#AddCountryIsoCode').val(),
                        PhoneCode: $('#AddCountryPhoneCode').val(),
                    };
               

                    $.ajax({
                        url: $('#url').data("addcountry"),
                        data: JSON.stringify(entry),
                        type: 'post',
                        cache: false,
                        contentType: "application/json; charset=utf-8",
                        beforesend: function () {
                            //c.buttondisable('#btnservicesave', true);
                        },
                        success: function (data) {

                            if (data.ErrorCode == 0) {
                                c.MessageBoxErr("error...", data.Message);
                                return;
                            }
                            c.MessageBox(data.Title, data.Message, function () {
                              
                            });



                        },
                        error: function (xhr, desc, err) {
                            // c.buttondisable('#btnservicesave', false);
                            var errmsg = "error in posting the data." + "<br>" + err + "<br>" + desc;
                            c.MessageBox("error...", errmsg, null);
                        }
                    });


                });
            },
            AddCity: function () {
                str = $('#CityTextArea').val().replace(/(?:\r\n|\r|\n)/g, ',');
                var partsOfStr = str.split(',');
                var cities = [];
                $.each(partsOfStr, function (index, itemData) {
                    if (itemData !== "") {
                        cities.push({
                            cityname: itemData
                        });
                    }
                   
                 
                });
               
                var entry = {
                    Id: $('#select2Country').val(),
                    CityName: cities,
                };
                console.log(entry);

                $.ajax({
                    url: $('#url').data("addcity"),
                    data: JSON.stringify(entry),
                    type: 'post',
                    cache: false,
                    contentType: "application/json; charset=utf-8",
                    beforesend: function () {
                        //c.buttondisable('#btnservicesave', true);
                    },
                    success: function (data) {

                        if (data.ErrorCode == 0) {
                            c.MessageBoxErr("error...", data.Message);
                            return;
                        }
                        c.MessageBox(data.Title, data.Message, function () {

                        });



                    },
                    error: function (xhr, desc, err) {
                        // c.buttondisable('#btnservicesave', false);
                        var errmsg = "error in posting the data." + "<br>" + err + "<br>" + desc;
                        c.MessageBox("error...", errmsg, null);
                    }
                });
            },
            FormSubmitAddCountry: function () {
                $('#FormSubmitAddCountry').find('[type="submit"]').trigger('click');
            },
            InitSelect2: function () {

                ajaxWrapper.Get($("#url").data("select2country"), null, function (xx, e) {
                    Sel2Client($("#select2Country"), xx, function (x) {
                        $("#CityTextArea").val([]);
                        $("#citylist").html("<option value=></option>");
                        ajaxWrapper.Get($("#url").data("select2city"), { id: x.id }, function (xx, e) {
                            var city = [];
                            $.each(xx, function (i, row) {
                                city.push(row.name);

                            });

                            $("#CityTextArea").val(city);
                            var ob = $("#citylist");
                            $.each(xx, function (index, itemData) {
                                ob.prepend("<option value=" + itemData.id + ">" + itemData.name + "</option>");
                            });


                        });

                    });
                });

            },
            loadDT: function () {
                ajaxWrapper.Get($("#url").data("dashboard"), null, function (x, e) {
                    ns.BindDashboard(x.list);
                });
              
            },
            loadDTCity: function () {
                if (quit) {
                    return;
                }
                quit = true;
                ajaxWrapper.Get($("#url").data("citylist"), null, function (x, e) {
                    ns.BindCityDashboard(x.list);
                });
            },
            BindDashboard: function (data) {


                Tbldashboard = $(TbldashboardId).DataTable({
                    cache: false,
                    destroy: true,
                    data: data,
                    paging: true,
                    ordering: true,
                    searching: true,
                    info: false,
                    pagingType: "full_numbers",
                    lengthMenu: [[100, 250, 500, -1], [100, 250, 500, "All"]],
                    autoWidth: false,
                    scrollX: "100%",
                    dom: '<"divtoolbar">Rlfrtip',
                    scrollCollapse: false,
                    columns: [
                        //searchable field
                         { data: "Id", visible: false, searchable: false, width: "0%" },
                         { data: "Name", visible: false, searchable: true, width: "0%" },
                         { data: "IsoCode", visible: false, searchable: true, width: "0%" },
                         { data: "PhoneCode", visible: false, searchable: true, width: "0%" },

                          //VIEWING

                        {
                            data: "", title: 'Name', className: ' ', visible: true, searchable: false, width: "10%", sortable: true,
                            "render": function (data, type, full, meta) {
                                var dataname = "Name_" + full.Id;


                                var html = '<div class="input-group input-group-sm col-sm-12"> ' +
                                        ' <input type="text" style="font-size: 10px;" class="form-control" id="' + dataname + '"   value="' + full.Name + '" >' +
                                        '<span class="input-group-btn">' +
                                        ' <button type="button"    data-itemid="' + full.Id + '"  data-input-id="' + dataname + '"  class="CLname btn btn-info btn-flat" style="width: 20px !important;padding: 0px; "> <i class="fa fa-fw fa-save"></i> </button>' +
                                        ' </span>' +
                                        ' </div>';

                                return html;
                            }

                        },

                         {
                             data: "", title: 'Iso Code Name', className: ' ', visible: true, searchable: false, width: "10%", sortable: true,
                             "render": function (data, type, full, meta) {
                                 var dataname = "IsoCode_" + full.Id;


                                 var html = '<div class="input-group input-group-sm col-sm-12"> ' +
                                         ' <input type="text" style="font-size: 10px;" class="form-control" id="' + dataname + '"   value="' + full.IsoCode + '" >' +
                                         '<span class="input-group-btn">' +
                                         ' <button type="button"    data-itemid="' + full.Id + '"  data-input-id="' + dataname + '"  class="CLisocode btn btn-info btn-flat" style="width: 20px !important;padding: 0px; "> <i class="fa fa-fw fa-save"></i> </button>' +
                                         ' </span>' +
                                         ' </div>';

                                 return html;
                             }

                         },

                         {
                             data: "", title: 'Phone Code', className: ' ', visible: true, searchable: false, width: "10%", sortable: true,
                             "render": function (data, type, full, meta) {
                                 var dataname = "PhoneCode_" + full.Id;


                                 var html = '<div class="input-group input-group-sm col-sm-12"> ' +
                                         ' <input type="text" style="font-size: 10px;" class="form-control" id="' + dataname + '"   value="' + full.PhoneCode + '" >' +
                                         '<span class="input-group-btn">' +
                                         ' <button type="button"    data-itemid="' + full.Id + '"  data-input-id="' + dataname + '"  class="CLphonecode btn btn-info btn-flat" style="width: 20px !important;padding: 0px; "> <i class="fa fa-fw fa-save"></i> </button>' +
                                         ' </span>' +
                                         ' </div>';

                                 return html;
                             }

                         },


                    ],

                });

                var btns = '';
                var toolbar = btns.concat(
                            ' <div style="background-color: skyblue; ">  '
                            , ' <div class="row has-warning">'
                            , ' <div class="col-xs-4">'
                            , '    <input type="text" class="form-control"   id="SearchName" placeholder="Search Name here...">'
                            , '  </div>'
                            , '  <div class="col-xs-4">'
                            , '      <input type="text" class="form-control"   id="SearchISO" placeholder="Search Code here..." >'
                            , '  </div>'
                            , '  <div class="col-xs-4">'
                            , '      <input type="text" class="form-control" id="Searchphone" placeholder="Search Phone here...">'
                            , '  </div>'
                            , ' </div>'
                            , ' </div>'
                     );
                $("div.divtoolbar").html(toolbar);
                $('#SearchName').on('keyup', function () {
                    console.log(this.value);
                    Tbldashboard
                        .columns(1)
                        .search(this.value)
                        .draw();
                });
                $('#SearchISO').on('keyup', function () {
                    Tbldashboard
                        .columns(2)
                        .search(this.value)
                        .draw();
                });
                $('#Searchphone').on('keyup', function () {
                    Tbldashboard
                        .columns(3)
                        .search(this.value)
                        .draw();
                });


                $(TbldashboardId + ' tbody').on('click', '.CLname', function (e) {
                    var datainputid = '#' + $(this).data("input-id");
                    var value = $.trim($(datainputid).val());
                    var itemid = $(this).data("itemid");

                    console.log(datainputid);
                    console.log(value);
                    console.log(itemid);

                    ns.saveInputText(itemid, value, "name")
                    return false;
                });
                $(TbldashboardId + ' tbody').on('click', '.CLisocode', function (e) {
                    var datainputid = '#' + $(this).data("input-id");
                    var value = $.trim($(datainputid).val());
                    var itemid = $(this).data("itemid");

                    console.log(datainputid);
                    console.log(value);
                    console.log(itemid);

                    ns.saveInputText(itemid, value, "iso")
                    return false;
                });
                $(TbldashboardId + ' tbody').on('click', '.CLphonecode', function (e) {
                    var datainputid = '#' + $(this).data("input-id");
                    var value = $.trim($(datainputid).val());
                    var itemid = $(this).data("itemid");

                    console.log(datainputid);
                    console.log(value);
                    console.log(itemid);

                    ns.saveInputText(itemid, value, "phone")
                    return false;
                });



            },
            BindCityDashboard: function (data) {

           
                TblDTCity = $(TblDTCityId).DataTable({
                    cache: false,
                    destroy: true,
                    data: data,
                    paging: true,
                    ordering: true,
                    searching: true,
                    info: false,
                    fixedHeader: true,
                    pagingType: "full_numbers",
                    lengthMenu: [[100, 250, 500, -1], [100, 250, 500, "All"]],
                    autoWidth: false,
                    scrollX: "100%",
                    dom: '<"divtoolbar">Rlfrtip',
                    scrollCollapse: false,
                    columns: [
                        //searchable field
                         { data: "CountryId", visible: false, searchable: false, width: "0%" },
                         { data: "CityId", visible: false, searchable: false, width: "0%" },
                         { data: "CountryName", visible: false, searchable: true, width: "0%" },
                         { data: "CityName", visible: false, searchable: true, width: "0%" },
                         { data: "IsoCode", visible: false, searchable: true, width: "0%" },
                         { data: "PhoneCode", visible: false, searchable: true, width: "0%" },
 
                          //VIEWING

                        {
                            data: "", title: 'Country', className: ' ', visible: true, searchable: false, width: "10%", sortable: true,
                            "render": function (data, type, full, meta) {
                                var dataname = "CountryName_" + full.CityId;
                                var html = '<div class="input-group input-group-sm col-sm-12"> ' +
                                        ' <input type="text" style="font-size: 10px;" class="form-control" id="' + dataname + '"   value="' + full.CountryName + '" disabled>' +
                                    
                                        ' </div>';
                                return html;
                            }

                        },
                          {
                               title: 'City', className: ' ', visible: true, searchable: false, width: "20%", sortable: true,
                              "render": function (data, type, full, meta) {
                                  var dataname = "CityName_" + full.CityId;
                                  var Name = full.Name;

                                  var html = '<div class="input-group input-group-sm col-sm-12"> ' +
                                             ' <input type="text" style="font-size: 10px;" class="form-control" id="' + dataname + '"   value="' + full.CityName + '" >' +
                                            '<span class="input-group-btn">' +
                                            ' <button type="button"  data-itemid="' + full.CityId + '"  data-input-id="' + dataname + '"  class="CLcityname btn btn-info btn-flat" style="width: 20px !important;padding: 0px; "> <i class="fa fa-fw fa-save"></i> </button>' +
                                              ' </span>' +
                                              ' </div>';

                                  return html;
                              }

                          },
                             {
                                 data: "", title: 'Phone Code', className: ' ', visible: true, searchable: false, width: "20%", sortable: true,
                                 "render": function (data, type, full, meta) {
                                     var dataname = "CityName_" + full.CityId;
                                     var html = '<div class="input-group input-group-sm col-sm-12"> ' +
                                                ' <input type="text" style="font-size: 10px;" class="form-control" id="' + dataname + '"   value="' + full.PhoneCode + '" disabled>' +
                                               '<span class="input-group-btn">' +
                                                 ' </span>' +
                                                 ' </div>';
                                     return html;
                                 }
                             },
                               {
                                   data: "", title: 'ISO Code', className: ' ', visible: true, searchable: false, width: "20%", sortable: true,
                                   "render": function (data, type, full, meta) {
                                       var dataname = "CityName_" + full.CityId;
                                       var html = '<div class="input-group input-group-sm col-sm-12"> ' +
                                                  ' <input type="text" style="font-size: 10px;" class="form-control" id="' + dataname + '"   value="' + full.IsoCode + '" disabled>' +
                                                 '<span class="input-group-btn">' +
                                                   ' </span>' +
                                                   ' </div>';
                                       return html;
                                   }
                               },
                               {
                                   data: "", title: 'Deleted', className: ' ', visible: true, searchable: false, width: "20%", sortable: true,
                                   "render": function (data, type, full, meta) {
                                       var dataname = "CityName_" + full.CityId;


                                       var html2 = '<div class="input-group input-group-sm col-sm-12"> ' +
                                                  ' <input type="text" style="font-size: 10px;" class="form-control" id="' + dataname + '"   value="' + full.IsoCode + '" disabled>' +
                                                 '<span class="input-group-btn">' +
                                                   ' </span>' +
                                                   ' </div>';
                                   
                                       if (full.Deleted == 1)
                                       {
                                           var selected = '  <option value="0" selected="selected"> Not Active</option><option value="1" >Active </option> ';
                                       } else {
                                           var selected = '  <option value="1" selected="selected"> Active </option> <option value="0" > Not Active</option> ';
                                       }
                                       var html = ' <div class="col-md-9">  ' +
                                                '   ' +
                                                ' <div class="form-group input-group-sm  ">  ' +
                                     
                                                ' <select class="form-control select2 ">  ' +
                                                '  ' + selected      
                                       ' </select> ' +
                                          
                                                ' </div>  ' +
                                                '    ' +
                                          '<span class="input-group-btn">' +
                                            ' <button type="button"  data-itemid="' + full.CityId + '"  data-input-id="' + dataname + '"  class="CLcityname btn btn-info btn-flat" style="width: 20px !important;padding: 0px; "> <i class="fa fa-fw fa-save"></i> </button>' +
                                              ' </span>' +
                                                '    ' +
                                                ' </div>  ';

                                       return html;
                                   }
                               },
        //public string CountryName { get; set; }
       //public string CityName { get; set; }
       //public string IsoCode { get; set; }
       //  public string PhoneCode { get; set; }
       //  public int Deleted { get; set; }
       //  public int CityId { get; set; }
       //  public int CountryId { get; set; }
 


                    ],

                });

                var btns = '';
                var toolbar = btns.concat(
                            ' <div style="background-color: skyblue; ">  '
                            , ' <div class="row has-warning">'
                            , ' <div class="col-xs-4">'
                            , '    <input type="text" class="form-control"   id="SearchName" placeholder="Search Name here...">'
                            , '  </div>'
                            , '  <div class="col-xs-4">'
                            , '      <input type="text" class="form-control"   id="SearchISO" placeholder="Search Code here..." >'
                            , '  </div>'
                            , '  <div class="col-xs-4">'
                            , '      <input type="text" class="form-control" id="Searchphone" placeholder="Search Phone here...">'
                            , '  </div>'
                            , ' </div>'
                            , ' </div>'
                     );
               // $("div.divtoolbar").html(toolbar);
                $('#SearchName').on('keyup', function () {
                    console.log(this.value);
                    TblDTCity
                        .columns(1)
                        .search(this.value)
                        .draw();
                });
                $('#SearchISO').on('keyup', function () {
                    TblDTCity
                        .columns(2)
                        .search(this.value)
                        .draw();
                });
                $('#Searchphone').on('keyup', function () {
                    TblDTCity
                        .columns(3)
                        .search(this.value)
                        .draw();
                });


                $(TblDTCityId + ' tbody').on('click', '.CLcityname', function (e) {
                    var datainputid = '#' + $(this).data("input-id");
                    var value = $.trim($(datainputid).val());
                    var itemid = $(this).data("itemid");
       
                    console.log(value);
                    console.log(itemid);
                   ns.saveCityText(itemid, value, "name")
                    return false;
                });
              
 

            }, saveCityText: function (id, value, type) {
                if (value == "") {
                    c.MessageBox("Error...", "Please input a value ", null);
                    return false;
                }      
                    var entry = {
                        Id: id
                       , CityName: value
                    };

                $.ajax({
                    url: $('#url').data("updatecity"),
                    data: JSON.stringify(entry),
                    type: 'post',
                    cache: false,
                    contentType: "application/json; charset=utf-8",
                    beforeSend: function () {

                    },
                    success: function (data) {

                        var OkFunc = function () {

                        };
                        NotifySuccess("Success!!", "City has been updated.");
                       // c.MessageBox(data.Title, "Country details has been updated.", OkFunc);
                    },
                    error: function (xhr, desc, err) {
                        var errMsg = "Error in posting the data." + "<br>" + err + "<br>" + desc;
                        c.MessageBox("Error...", errMsg, null);
                    }
                });


            }, saveInputText: function (id, value, type) {
                if (value == "") {
                    c.MessageBox("Error...", "Please input a value ", null);
                    return false;
                }
                if (type == "name") {
                    var entry = {
                        Id: id
                       , Name: value
                    };
                }
                if (type == "iso") {
                    var entry = {
                        Id: id
                       , IsoCode: value
                    };
                }
                if (type == "phone") {
                    var entry = {
                        Id: id
                       , PhoneCode: value
                    };
                }



                $.ajax({
                    url: $('#url').data("save"),
                    data: JSON.stringify(entry),
                    type: 'post',
                    cache: false,
                    contentType: "application/json; charset=utf-8",
                    beforeSend: function () {

                    },
                    success: function (data) {

                        var OkFunc = function () {

                        };
                        c.MessageBox(data.Title, "Country details has been updated.", OkFunc);
                    },
                    error: function (xhr, desc, err) {
                        var errMsg = "Error in posting the data." + "<br>" + err + "<br>" + desc;
                        c.MessageBox("Error...", errMsg, null);
                    }
                });


            }

        };
        window.ns = namespace;

    })(this.jQuery);




</script>
